<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å³æ™‚èªæ„åˆ†æå¼•æ“ - å¾Œç«¯æ¸¬è©¦é é¢</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom": "https://esm.sh/react-dom@18.2.0",
            "react/jsx-runtime": "https://esm.sh/react@18.2.0/jsx-runtime"
        }
    }
    </script>
    <style>
        @keyframes pulse-dot {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-dot {
            animation: pulse-dot 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';

        // ========== å¯¦é«”è©å…¸å®šç¾© ==========
        const EMPLOYMENT_ENTITIES = {
            "å¾…æ¥­ä¸­": ["å¤±æ¥­", "å¾…æ¥­", "æ‰¾å·¥ä½œ", "æ²’æœ‰å·¥ä½œ", "é›¢è·", "è¢«è³‡é£", "ç„¡æ¥­", "å¤±æ¥­ä¸­"],
            "åœ¨è·ä¸­": ["ä¸Šç­", "å·¥ä½œ", "å°±æ¥­", "ä»»è·", "åœ¨è·", "ç›®å‰å·¥ä½œ", "ç¾è·"],
            "å­¸ç”Ÿ": ["å­¸ç”Ÿ", "å°±è®€", "ä¸Šå­¸", "å¿µæ›¸", "åœ¨å­¸"]
        };

        const FAMILY_ENTITIES = {
            "æœ‰å­å¥³": ["å…’å­", "å¥³å…’", "å°å­©", "å­©å­", "å­å¥³", "è®€åœ‹ä¸­", "è®€å°å­¸", "è®€é«˜ä¸­", "è®€å¤§å­¸", "åœ‹ä¸­", "å°å­¸", "é«˜ä¸­", "å¤§å­¸"],
            "å·²å©š": ["å¤ªå¤ª", "å…ˆç”Ÿ", "é…å¶", "è€å…¬", "è€å©†", "çµå©š", "å¦»å­", "ä¸ˆå¤«"],
            "å–®è¦ª": ["å–®è¦ª", "é›¢å©š", "åˆ†å±…"],
            "æœ‰é•·è¼©": ["çˆ¶æ¯", "é•·è¼©", "ç…§é¡§", "é•·ç…§", "è€äººå®¶", "è€äºº"]
        };

        const CAREER_ENTITIES = {
            "è³‡è¨Šç§‘æŠ€": ["å·¥ç¨‹å¸«", "ç¨‹å¼", "è»Ÿé«”", "ç¶²è·¯", "IT", "è³‡è¨Š", "é›»è…¦", "é–‹ç™¼", "ç¨‹å¼è¨­è¨ˆ", "ç¶²è·¯å·¥ç¨‹å¸«", "è»Ÿé«”å·¥ç¨‹å¸«"],
            "é¤é£²": ["é¤é£²", "å’–å•¡", "çƒ˜ç„™", "çƒ¹é£ª", "å»šå¸«", "æ–™ç†", "ç…®", "é¤å»³"],
            "è¨­è¨ˆ": ["è¨­è¨ˆ", "UI", "UX", "ç¾ç·¨", "å¹³é¢", "å¤šåª’é«”", "è¦–è¦º", "Figma"],
            "å•†æ¥­": ["è¡ŒéŠ·", "ç®¡ç†", "å•†æ¥­", "é›»å•†", "æ¥­å‹™", "ESG"],
            "ç¶­ä¿®": ["ç¶­ä¿®", "æ©Ÿæ¢°", "PLC", "è‡ªå‹•åŒ–", "å·¥ç¨‹", "æ©Ÿé›»"],
            "èªè¨€": ["è‹±æ–‡", "æ—¥æ–‡", "èªè¨€", "æºé€š", "ç¿»è­¯"],
            "é†«ç™‚": ["é†«ç™‚", "ç…§è­·", "é•·ç…§", "è­·ç†", "å¥åº·"]
        };

        const LOCATION_ENTITIES = {
            "å°åŒ—": ["å°åŒ—", "åŒ—å¸‚", "Taipei", "å°åŒ—å¸‚"],
            "æ–°åŒ—": ["æ–°åŒ—", "æ¿æ©‹", "æ–°åº—", "ä¸‰é‡", "æ–°åŒ—å¸‚"],
            "å°ä¸­": ["å°ä¸­", "ä¸­å¸‚", "Taichung", "å°ä¸­å¸‚"],
            "é«˜é›„": ["é«˜é›„", "é«˜å¸‚", "Kaohsiung", "é«˜é›„å¸‚"],
            "æ¡ƒåœ’": ["æ¡ƒåœ’", "æ¡ƒå¸‚", "æ¡ƒåœ’å¸‚"],
            "å°å—": ["å°å—", "å—å¸‚", "å°å—å¸‚"],
            "ç·šä¸Š": ["ç·šä¸Š", "ç›´æ’­", "é è·", "ç¶²è·¯", "online", "é ç«¯"]
        };

        const SUBSIDY_ENTITIES = {
            "éœ€è¦è£œåŠ©": ["è£œåŠ©", "è£œè²¼", "æ´¥è²¼", "è£œåŠ©é‡‘", "å…è²»", "è²»ç”¨", "è£œåŠ©å—", "æœ‰è£œåŠ©"],
            "ç¶“æ¿Ÿå›°é›£": ["ç¶“æ¿Ÿ", "å›°é›£", "æ²’éŒ¢", "è² æ“”", "æ”¶å…¥", "ç¶“æ¿Ÿå£“åŠ›"]
        };

        const ENTITY_DICTIONARIES = {
            "å°±æ¥­ç‹€æ…‹": EMPLOYMENT_ENTITIES,
            "å®¶åº­èƒŒæ™¯": FAMILY_ENTITIES,
            "è·æ¥­èƒŒæ™¯": CAREER_ENTITIES,
            "åœ°é»": LOCATION_ENTITIES,
            "è£œåŠ©éœ€æ±‚": SUBSIDY_ENTITIES
        };

        // ========== æ¨è«–è¦å‰‡ ==========
        const INFERENCE_RULES = [
            {
                condition: (entities, context) => {
                    return entities.some(e => 
                        e.category === "å°±æ¥­ç‹€æ…‹" && 
                        ["å¤±æ¥­", "å¾…æ¥­", "æ‰¾å·¥ä½œ", "æ²’æœ‰å·¥ä½œ", "é›¢è·", "è¢«è³‡é£"].includes(e.text)
                    );
                },
                inference: {
                    category: "å°±æ¥­ç‹€æ…‹",
                    tag: "ç‹€æ…‹:å¾…æ¥­ä¸­",
                    confidence: 99,
                    reason: "æ˜ç¢ºæåŠå¤±æ¥­ç›¸é—œè©å½™"
                }
            },
            {
                condition: (entities, context) => {
                    return entities.some(e => 
                        e.category === "å®¶åº­èƒŒæ™¯" && 
                        ["å…’å­", "å¥³å…’", "å°å­©", "å­©å­", "å­å¥³"].includes(e.text)
                    );
                },
                inference: {
                    category: "å®¶åº­èƒŒæ™¯",
                    tag: "æœ‰å­å¥³",
                    confidence: 98,
                    reason: "æ˜ç¢ºæåŠå­å¥³"
                }
            },
            {
                condition: (entities, context) => {
                    return entities.some(e => 
                        e.category === "å®¶åº­èƒŒæ™¯" && 
                        ["å¤ªå¤ª", "å…ˆç”Ÿ", "é…å¶", "è€å…¬", "è€å©†", "å¦»å­", "ä¸ˆå¤«"].includes(e.text)
                    );
                },
                inference: {
                    category: "å°±æ¥­ç‹€æ…‹",
                    tag: "å·²å©š(æ¨è«–)",
                    confidence: 85,
                    reason: "æåŠé…å¶ç›¸é—œè©å½™"
                }
            },
            {
                condition: (entities, context) => {
                    const hasWorkMention = entities.some(e => 
                        e.category === "å°±æ¥­ç‹€æ…‹" && e.text === "ä¸Šç­"
                    );
                    const hasNegative = context.includes("æ²’æœ‰") || context.includes("æ²’") || 
                                       context.includes("ä¸") || context.includes("ç„¡");
                    return hasWorkMention && hasNegative;
                },
                inference: {
                    category: "å°±æ¥­ç‹€æ…‹",
                    tag: "ç‹€æ…‹:å¾…æ¥­ä¸­",
                    confidence: 95,
                    reason: "è² é¢ä¸Šä¸‹æ–‡ + å·¥ä½œç›¸é—œè©å½™"
                }
            },
            {
                condition: (entities, context) => {
                    return entities.some(e => 
                        e.category === "è£œåŠ©éœ€æ±‚" && 
                        ["è£œåŠ©", "è£œè²¼", "æ´¥è²¼", "è£œåŠ©é‡‘", "å…è²»", "æœ‰è£œåŠ©"].includes(e.text)
                    );
                },
                inference: {
                    category: "è£œåŠ©éœ€æ±‚",
                    tag: "éœ€è¦è£œåŠ©",
                    confidence: 90,
                    reason: "æ˜ç¢ºæåŠè£œåŠ©éœ€æ±‚"
                }
            },
            {
                condition: (entities, context) => {
                    return entities.some(e => e.category === "è·æ¥­èƒŒæ™¯");
                },
                inference: (entities, context) => {
                    const careerEntity = entities.find(e => e.category === "è·æ¥­èƒŒæ™¯");
                    return {
                        category: "è·æ¥­èƒŒæ™¯",
                        tag: `èˆˆè¶£é ˜åŸŸ:${careerEntity.tag}`,
                        confidence: 85,
                        reason: `æåŠ${careerEntity.tag}ç›¸é—œè©å½™`
                    };
                }
            }
        ];

        // ========== æ ¸å¿ƒåˆ†æå‡½æ•¸ ==========
        function extractEntities(text, entityDictionaries = ENTITY_DICTIONARIES) {
            if (!text || typeof text !== 'string') {
                return [];
            }

            const entities = [];
            const normalizedText = text.trim();

            for (const [category, dictionary] of Object.entries(entityDictionaries)) {
                for (const [tag, keywords] of Object.entries(dictionary)) {
                    for (const keyword of keywords) {
                        const index = normalizedText.indexOf(keyword);
                        if (index !== -1) {
                            const isDuplicate = entities.some(e => 
                                e.text === keyword && 
                                e.category === category && 
                                e.tag === tag
                            );
                            
                            if (!isDuplicate) {
                                entities.push({
                                    text: keyword,
                                    category,
                                    tag,
                                    position: index
                                });
                            }
                        }
                    }
                }
            }

            return entities.sort((a, b) => a.position - b.position);
        }

        function inferUserProfile(entities, context, currentProfile = {}) {
            if (!entities || entities.length === 0) {
                return [];
            }

            const inferences = [];

            for (const rule of INFERENCE_RULES) {
                try {
                    if (rule.condition(entities, context)) {
                        let inference;
                        if (typeof rule.inference === 'function') {
                            inference = rule.inference(entities, context);
                        } else {
                            inference = { ...rule.inference };
                        }

                        const sourceEntities = entities.filter(e => 
                            rule.condition([e], context)
                        );

                        inferences.push({
                            ...inference,
                            timestamp: new Date().toISOString(),
                            sourceEntities: sourceEntities.length > 0 ? sourceEntities : entities.slice(0, 1)
                        });
                    }
                } catch (error) {
                    console.warn('æ¨è«–è¦å‰‡åŸ·è¡ŒéŒ¯èª¤:', error);
                }
            }

            return inferences;
        }

        function updateUserProfile(profile, inferences) {
            if (!inferences || inferences.length === 0) {
                return profile;
            }

            const updated = {
                employmentStatus: profile.employmentStatus || null,
                familyBackground: {
                    hasChildren: profile.familyBackground?.hasChildren || { value: false, confidence: 0, sources: [] },
                    maritalStatus: profile.familyBackground?.maritalStatus || { value: null, confidence: 0, sources: [] },
                    hasElderly: profile.familyBackground?.hasElderly || { value: false, confidence: 0, sources: [] }
                },
                careerBackground: {
                    currentDomain: profile.careerBackground?.currentDomain || [],
                    interestedDomain: profile.careerBackground?.interestedDomain || [],
                    previousJobs: profile.careerBackground?.previousJobs || []
                },
                locationPreference: {
                    preferred: profile.locationPreference?.preferred || [],
                    avoid: profile.locationPreference?.avoid || []
                },
                subsidyNeed: {
                    requiresSubsidy: profile.subsidyNeed?.requiresSubsidy || false,
                    urgency: profile.subsidyNeed?.urgency || "ä½",
                    reasons: profile.subsidyNeed?.reasons || []
                },
                conversationHistory: profile.conversationHistory || []
            };

            for (const inference of inferences) {
                switch (inference.category) {
                    case "å°±æ¥­ç‹€æ…‹":
                        if (!updated.employmentStatus || 
                            inference.confidence > updated.employmentStatus.confidence) {
                            updated.employmentStatus = {
                                value: inference.tag,
                                confidence: inference.confidence,
                                sources: [...(updated.employmentStatus?.sources || []), inference]
                            };
                        }
                        break;

                    case "å®¶åº­èƒŒæ™¯":
                        if (inference.tag === "æœ‰å­å¥³") {
                            if (!updated.familyBackground.hasChildren.value || 
                                inference.confidence > updated.familyBackground.hasChildren.confidence) {
                                updated.familyBackground.hasChildren = {
                                    value: true,
                                    confidence: inference.confidence,
                                    sources: [...(updated.familyBackground.hasChildren.sources || []), inference]
                                };
                            }
                        } else if (inference.tag === "å·²å©š(æ¨è«–)") {
                            if (!updated.familyBackground.maritalStatus.value || 
                                inference.confidence > updated.familyBackground.maritalStatus.confidence) {
                                updated.familyBackground.maritalStatus = {
                                    value: "å·²å©š",
                                    confidence: inference.confidence,
                                    sources: [...(updated.familyBackground.maritalStatus.sources || []), inference]
                                };
                            }
                        }
                        break;

                    case "è·æ¥­èƒŒæ™¯":
                        if (inference.tag && inference.tag.startsWith("èˆˆè¶£é ˜åŸŸ:")) {
                            const domain = inference.tag.replace("èˆˆè¶£é ˜åŸŸ:", "");
                            if (!updated.careerBackground.interestedDomain.includes(domain)) {
                                updated.careerBackground.interestedDomain.push(domain);
                            }
                        }
                        break;

                    case "è£œåŠ©éœ€æ±‚":
                        if (inference.tag === "éœ€è¦è£œåŠ©") {
                            updated.subsidyNeed.requiresSubsidy = true;
                            if (!updated.subsidyNeed.reasons.includes(inference.reason)) {
                                updated.subsidyNeed.reasons.push(inference.reason);
                            }
                            if (inference.confidence >= 90) {
                                updated.subsidyNeed.urgency = "é«˜";
                            } else if (inference.confidence >= 80) {
                                updated.subsidyNeed.urgency = "ä¸­";
                            }
                        }
                        break;

                    case "åœ°é»":
                        if (inference.tag && !updated.locationPreference.preferred.includes(inference.tag)) {
                            updated.locationPreference.preferred.push(inference.tag);
                        }
                        break;
                }
            }

            return updated;
        }

        function analyzeUserInput(userInput, currentProfile = {}) {
            const entities = extractEntities(userInput);
            const inferences = inferUserProfile(entities, userInput, currentProfile);
            const updatedProfile = updateUserProfile(currentProfile, inferences);
            
            return {
                entities,
                inferences,
                updatedProfile
            };
        }

        // ========== React çµ„ä»¶ ==========
        function SemanticAnalysisEngine({ userInput, onProfileUpdate }) {
            const [userProfile, setUserProfile] = useState({
                employmentStatus: null,
                familyBackground: {
                    hasChildren: { value: false, confidence: 0, sources: [] },
                    maritalStatus: { value: null, confidence: 0, sources: [] },
                    hasElderly: { value: false, confidence: 0, sources: [] }
                },
                careerBackground: {
                    currentDomain: [],
                    interestedDomain: [],
                    previousJobs: []
                },
                locationPreference: {
                    preferred: [],
                    avoid: []
                },
                subsidyNeed: {
                    requiresSubsidy: false,
                    urgency: "ä½",
                    reasons: []
                },
                conversationHistory: []
            });
            
            const [inferenceLog, setInferenceLog] = useState([]);
            const [isAnalyzing, setIsAnalyzing] = useState(false);

            useEffect(() => {
                if (!userInput || !userInput.trim()) {
                    return;
                }
                
                setIsAnalyzing(true);
                
                setTimeout(() => {
                    const analysis = analyzeUserInput(userInput, userProfile);
                    
                    const logEntry = {
                        timestamp: new Date().toLocaleTimeString('zh-TW', { 
                            hour12: true,
                            hour: '2-digit',
                            minute: '2-digit',
                            second: '2-digit'
                        }),
                        entities: analysis.entities,
                        inferences: analysis.inferences,
                        userInput
                    };
                    
                    setInferenceLog(prev => [...prev, logEntry]);
                    setUserProfile(analysis.updatedProfile);
                    setIsAnalyzing(false);
                    
                    if (onProfileUpdate) {
                        onProfileUpdate(analysis.updatedProfile);
                    }
                }, 300);
                
            }, [userInput]);

            const getConfidenceColor = (confidence) => {
                if (confidence >= 90) return 'text-green-400';
                if (confidence >= 80) return 'text-yellow-400';
                return 'text-orange-400';
            };

            return React.createElement('div', {
                className: "w-full h-full bg-slate-900 text-white rounded-lg shadow-xl flex flex-col overflow-hidden border border-slate-700"
            }, [
                // Header
                React.createElement('div', {
                    key: 'header',
                    className: "bg-slate-800 p-4 flex justify-between items-center border-b border-slate-700"
                }, [
                    React.createElement('h2', {
                        key: 'title',
                        className: "text-lg font-bold text-white"
                    }, "å³æ™‚èªæ„åˆ†æå¼•æ“"),
                    React.createElement('button', {
                        key: 'logs-btn',
                        className: "text-xs text-slate-400 hover:text-white px-2 py-1 rounded"
                    }, "System Logs")
                ]),

                // Content
                React.createElement('div', {
                    key: 'content',
                    className: "flex-1 overflow-y-auto p-4 space-y-6"
                }, [
                    // System Status
                    React.createElement('div', {
                        key: 'status',
                        className: "flex items-center gap-2"
                    }, [
                        React.createElement('div', {
                            key: 'dot',
                            className: `w-2 h-2 rounded-full ${isAnalyzing ? 'bg-green-400 pulse-dot' : 'bg-green-500'}`
                        }),
                        React.createElement('span', {
                            key: 'status-text',
                            className: "text-sm text-slate-300"
                        }, isAnalyzing ? 'AI Analyzing Context...' : 'System Idle. Waiting for input.')
                    ]),

                    // Detected Profile
                    React.createElement('div', { key: 'profile' }, [
                        React.createElement('h3', {
                            key: 'profile-title',
                            className: "text-sm font-bold text-slate-400 mb-3 uppercase tracking-wide"
                        }, "DETECTED PROFILE"),
                        
                        (!userProfile.employmentStatus && 
                         !userProfile.familyBackground.hasChildren.value &&
                         !userProfile.careerBackground.interestedDomain.length &&
                         !userProfile.subsidyNeed.requiresSubsidy) ? 
                        React.createElement('div', {
                            key: 'empty',
                            className: "bg-slate-800 p-4 rounded border border-slate-700 text-slate-400 text-sm"
                        }, "å°šæœªåµæ¸¬åˆ°ä½¿ç”¨è€…ç‰¹å¾µ") :
                        React.createElement('div', {
                            key: 'profile-items',
                            className: "space-y-2"
                        }, [
                            userProfile.employmentStatus && React.createElement('div', {
                                key: 'employment',
                                className: "bg-slate-800 p-3 rounded border border-slate-700"
                            }, [
                                React.createElement('div', {
                                    key: 'label',
                                    className: "text-xs text-slate-400 mb-1"
                                }, "å°±æ¥­ç‹€æ…‹"),
                                React.createElement('div', {
                                    key: 'value',
                                    className: "flex items-center justify-between"
                                }, [
                                    React.createElement('span', {
                                        key: 'tag',
                                        className: "text-sm font-medium text-white"
                                    }, userProfile.employmentStatus.value),
                                    React.createElement('span', {
                                        key: 'confidence',
                                        className: `text-xs font-bold ${getConfidenceColor(userProfile.employmentStatus.confidence)}`
                                    }, `${userProfile.employmentStatus.confidence}%`)
                                ])
                            ]),
                            
                            userProfile.familyBackground.hasChildren.value && React.createElement('div', {
                                key: 'children',
                                className: "bg-slate-800 p-3 rounded border border-slate-700"
                            }, [
                                React.createElement('div', {
                                    key: 'label',
                                    className: "text-xs text-slate-400 mb-1"
                                }, "å®¶åº­èƒŒæ™¯"),
                                React.createElement('div', {
                                    key: 'value',
                                    className: "flex items-center justify-between"
                                }, [
                                    React.createElement('span', {
                                        key: 'tag',
                                        className: "text-sm font-medium text-white"
                                    }, "æœ‰å­å¥³"),
                                    React.createElement('span', {
                                        key: 'confidence',
                                        className: `text-xs font-bold ${getConfidenceColor(userProfile.familyBackground.hasChildren.confidence)}`
                                    }, `${userProfile.familyBackground.hasChildren.confidence}%`)
                                ])
                            ]),
                            
                            userProfile.familyBackground.maritalStatus.value && React.createElement('div', {
                                key: 'marital',
                                className: "bg-slate-800 p-3 rounded border border-slate-700"
                            }, [
                                React.createElement('div', {
                                    key: 'label',
                                    className: "text-xs text-slate-400 mb-1"
                                }, "å°±æ¥­ç‹€æ…‹"),
                                React.createElement('div', {
                                    key: 'value',
                                    className: "flex items-center justify-between"
                                }, [
                                    React.createElement('span', {
                                        key: 'tag',
                                        className: "text-sm font-medium text-white"
                                    }, `${userProfile.familyBackground.maritalStatus.value}(æ¨è«–)`),
                                    React.createElement('span', {
                                        key: 'confidence',
                                        className: `text-xs font-bold ${getConfidenceColor(userProfile.familyBackground.maritalStatus.confidence)}`
                                    }, `${userProfile.familyBackground.maritalStatus.confidence}%`)
                                ])
                            ]),
                            
                            userProfile.subsidyNeed.requiresSubsidy && React.createElement('div', {
                                key: 'subsidy',
                                className: "bg-slate-800 p-3 rounded border border-slate-700"
                            }, [
                                React.createElement('div', {
                                    key: 'label',
                                    className: "text-xs text-slate-400 mb-1"
                                }, "è£œåŠ©éœ€æ±‚"),
                                React.createElement('div', {
                                    key: 'value',
                                    className: "flex items-center justify-between"
                                }, [
                                    React.createElement('span', {
                                        key: 'tag',
                                        className: "text-sm font-medium text-white"
                                    }, "éœ€è¦è£œåŠ©"),
                                    React.createElement('span', {
                                        key: 'urgency',
                                        className: "text-xs font-bold text-yellow-400"
                                    }, userProfile.subsidyNeed.urgency)
                                ])
                            ])
                        ])
                    ]),

                    // Inference Log
                    inferenceLog.length > 0 && React.createElement('div', { key: 'log' }, [
                        React.createElement('h3', {
                            key: 'log-title',
                            className: "text-sm font-bold text-slate-400 mb-3 uppercase tracking-wide"
                        }, "REAL-TIME INFERENCE LOG"),
                        React.createElement('div', {
                            key: 'log-entries',
                            className: "space-y-2 max-h-48 overflow-y-auto"
                        }, inferenceLog.slice().reverse().map((entry, idx) => 
                            React.createElement('div', {
                                key: idx,
                                className: "bg-slate-800 p-3 rounded border border-slate-700 text-xs"
                            }, [
                                React.createElement('div', {
                                    key: 'timestamp',
                                    className: "text-slate-400 mb-1"
                                }, `[${entry.timestamp}]`),
                                ...entry.inferences.map((inf, i) => 
                                    React.createElement('div', {
                                        key: i,
                                        className: "text-slate-300 mt-1"
                                    }, `Extracted entity "${inf.sourceEntities[0]?.text || 'N/A'}" â†’ Mapped to tag [${inf.tag}]`)
                                )
                            ])
                        ))
                    ])
                ])
            ]);
        }

        // ========== ä¸»æ‡‰ç”¨çµ„ä»¶ ==========
        function App() {
            const [input, setInput] = useState("");
            const [lastUserInput, setLastUserInput] = useState("");
            const [userProfile, setUserProfile] = useState(null);
            const [testCases, setTestCases] = useState([]);
            
            // ç›£è½ä¾†è‡ª ChatBot çš„è¨Šæ¯
            useEffect(() => {
                const handleStorageChange = (e) => {
                    if (e.key === 'chatbot-user-input') {
                        const userInput = e.newValue;
                        if (userInput) {
                            setInput(userInput);
                            setLastUserInput(userInput);
                        }
                    }
                };
                
                window.addEventListener('storage', handleStorageChange);
                
                // æª¢æŸ¥æ˜¯å¦æœ‰åˆå§‹è³‡æ–™
                const initialInput = localStorage.getItem('chatbot-user-input');
                if (initialInput) {
                    setInput(initialInput);
                    setLastUserInput(initialInput);
                }
                
                return () => {
                    window.removeEventListener('storage', handleStorageChange);
                };
            }, []);

            const handleSend = () => {
                if (!input.trim()) return;
                setLastUserInput(input);
                setInput("");
            };

            const handleTestCase = (testCase) => {
                setInput(testCase);
                setLastUserInput(testCase);
            };

            return React.createElement('div', {
                className: "min-h-screen bg-gray-100 p-8"
            }, [
                // Header
                React.createElement('div', {
                    key: 'header',
                    className: "mb-6"
                }, [
                    React.createElement('h1', {
                        key: 'title',
                        className: "text-3xl font-bold text-gray-800 mb-2"
                    }, "å³æ™‚èªæ„åˆ†æå¼•æ“ - å¾Œç«¯æ¸¬è©¦é é¢"),
                    React.createElement('p', {
                        key: 'desc',
                        className: "text-gray-600"
                    }, "æ­¤é é¢ç”¨æ–¼æ¸¬è©¦å’Œå±•ç¤ºèªæ„åˆ†æå¼•æ“çš„åŠŸèƒ½ï¼Œä¾›å¾Œç«¯é–‹ç™¼äººå“¡ä½¿ç”¨")
                ]),

                // Main Content
                React.createElement('div', {
                    key: 'main',
                    className: "grid grid-cols-1 lg:grid-cols-2 gap-6"
                }, [
                    // Left Panel - Input
                    React.createElement('div', {
                        key: 'left',
                        className: "bg-white rounded-lg shadow-lg p-6"
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: "text-xl font-bold mb-4"
                        }, "æ¸¬è©¦è¼¸å…¥"),
                        
                        React.createElement('div', {
                            key: 'input-group',
                            className: "mb-4"
                        }, [
                            React.createElement('textarea', {
                                key: 'textarea',
                                value: input,
                                onChange: (e) => setInput(e.target.value),
                                placeholder: "è¼¸å…¥æ¸¬è©¦æ–‡å­—...",
                                className: "w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",
                                rows: 4
                            }),
                            React.createElement('button', {
                                key: 'send-btn',
                                onClick: handleSend,
                                className: "mt-2 w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"
                            }, "åˆ†æ")
                        ]),

                        React.createElement('div', {
                            key: 'chatbot-status',
                            className: "mt-4"
                        }, [
                            React.createElement('div', {
                                key: 'status-box',
                                className: "bg-blue-50 border border-blue-200 rounded-lg p-3"
                            }, [
                                React.createElement('div', {
                                    key: 'status-icon',
                                    className: "flex items-center gap-2 text-sm text-blue-700"
                                }, [
                                    React.createElement('span', {
                                        key: 'icon',
                                        className: "text-lg"
                                    }, "ğŸ¤–"),
                                    React.createElement('span', {
                                        key: 'text',
                                        className: "font-medium"
                                    }, "å³æ™‚åŒæ­¥ ChatBot å°è©±")
                                ]),
                                React.createElement('p', {
                                    key: 'hint',
                                    className: "text-xs text-blue-600 mt-1"
                                }, "ç•¶æ‚¨åœ¨ä¸»ç¶²ç«™çš„ ChatBot ä¸­è¼¸å…¥è¨Šæ¯æ™‚ï¼Œå…§å®¹æœƒè‡ªå‹•åŒæ­¥åˆ°æ­¤é é¢é€²è¡Œåˆ†æ")
                            ])
                        ])
                    ]),

                    // Right Panel - Analysis Engine
                    React.createElement('div', {
                        key: 'right',
                        className: "h-[800px]"
                    }, React.createElement(SemanticAnalysisEngine, {
                        userInput: lastUserInput,
                        onProfileUpdate: setUserProfile
                    }))
                ])
            ]);
        }

        // ========== æ¸²æŸ“æ‡‰ç”¨ ==========
        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>

